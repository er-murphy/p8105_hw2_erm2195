---
title: "P8105 Homework 2"
output: github_document
date: "2023-10-02"
---

# Problem 1
Goal: merging the FiveThirtyEight `pols-month.csv`, `unemployment.csv`, and `snp.csv` data into a single data frame using year and month as keys across datasets.

## Loading Libraries
First, loading the `tidyverse` library for use throughout the homework.
```{r library}
library(tidyverse)
```

## Cleaning `pols-month` Data
Now, cleaning the data in `pols-month.csv`:

* Using separate() to break up the variable `mon` into integer variables `year`, `month`, and `day`
* Replacing month number with month name
* Creating a `president` variable taking values "gop" and "dem"
* Removing `prez_dem` and `prez_gop` variables
* Removing the `day` variable

```{r cleaning_pols}

pols = 
  read_csv("Data/pols-month.csv") |> 
  janitor::clean_names() |> 
  separate(mon, into = c("year", "month", "day"), sep = "-") |> 
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    day = as.integer(day),
    president = ifelse(prez_dem > 0 , "dem", "gop"),
    month = case_match(month,
      1 ~ "January",
      2 ~ "February",
      3 ~ "March",
      4 ~ "April",
      5 ~ "May",
      6 ~ "June",
      7 ~ "July",
      8 ~ "August",
      9 ~ "September",
      10 ~ "October",
      11 ~ "November",
      12 ~ "December")
  ) |> 
  select(-starts_with("prez"), -day)

```

## Cleaning `snp` Data
Second, cleaning the data in `snp.csv` using a similar process:

* Using separate() to break up the variable `date` into integer variables `year`, `month`, and `day`
* Converting the `year` variable into a 4 digit value
* Replacing month number with month name
* Reorganizing so that year and month are the leading columns
* Removing the `day` variable

```{r cleaning_snp}
snp = 
  read_csv("Data/snp.csv") |> 
  janitor::clean_names() |> 
  separate(date, into = c("month", "day", "year"), sep = "/") |> 
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    day = as.integer(day),
    year = ifelse(as.integer(year) < 24, as.integer(year) + 2000, as.integer(year) + 1900),
    month = case_match(month,
      1 ~ "January",
      2 ~ "February",
      3 ~ "March",
      4 ~ "April",
      5 ~ "May",
      6 ~ "June",
      7 ~ "July",
      8 ~ "August",
      9 ~ "September",
      10 ~ "October",
      11 ~ "November",
      12 ~ "December")
  ) |> 
  select(year, month, close)

```

## Cleaning `unemployment` Data
Third, tidying the data in `unemployment.csv` so that it can be merged with the other two datasets:

* Switch from "wide" to "long" format - turn months into a single column, and the value of existing `months` column into a column called `percent_unemployment`
* Converting month names to capitalized full names to match the format of other datasets

```{r cleaning_unemployment}
unemployment = 
  read_csv("Data/unemployment.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(jan:dec, names_to = "month", values_to = "percent_unemployment") |> 
  mutate(
    month = case_match(month,
    "jan" ~ "January",
    "feb" ~ "February",
    "mar" ~ "March",
    "apr" ~ "April",
    "may" ~ "May",
    "jun" ~ "June",
    "jul" ~ "July",
    "aug" ~ "August",
    "sep" ~ "September",
    "oct" ~ "October",
    "nov" ~ "November",
    "dec" ~ "December")
  )
```

## Merging the Data Sets
Joining the datasets by merging `snp` into `pols`, and then merging `unemployment` into the result. The resulting dataset is called `data_538`
```{r merging_datasets}

data_538 = left_join(pols, snp) |> 
  left_join(x = _, y = unemployment)

str(data_538)
```

## Description of the Combined Data Set
The `pols` data has `r nrow(pols)` observations and `r ncol(pols)` variables and tells us about the party affiliation distribution (democrat or republican) for governors and senators in a given year from `r pols |> pull(year) |> min()` to `r pols |> pull(year) |> max()`.



USE MR. TRASH WHEEL DATA FOR 2023 FOR HOMEWORK

